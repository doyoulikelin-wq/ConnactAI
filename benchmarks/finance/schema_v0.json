{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Finance benchmark case (v0.1)",
  "type": "object",
  "required": ["id", "domain", "input", "expected"],
  "properties": {
    "id": { "type": "string", "minLength": 1 },
    "version": { "type": "string" },
    "domain": { "type": "string", "const": "finance" },
    "track": { "type": "string" },
    "created_at": { "type": "string" },
    "source": {
      "type": "object",
      "required": ["type"],
      "properties": {
        "type": {
          "type": "string",
          "enum": ["synthetic", "survey", "interview", "support_ticket", "internal"]
        },
        "source_id": { "type": "string" },
        "notes": { "type": "string" }
      },
      "additionalProperties": true
    },
    "input": {
      "type": "object",
      "required": ["find_recommendations_request", "generate_email_request"],
      "properties": {
        "find_recommendations_request": {
          "type": "object",
          "required": ["purpose", "field"],
          "properties": {
            "purpose": { "type": "string", "minLength": 1 },
            "field": { "type": "string", "minLength": 1 },
            "sender_profile": { "$ref": "#/$defs/profileBase" },
            "preferences": { "$ref": "#/$defs/targetingPreferences" }
          },
          "additionalProperties": true
        },
        "benchmark_context": {
          "type": "object",
          "properties": {
            "candidate_pool": {
              "type": "array",
              "items": { "$ref": "#/$defs/candidate" }
            },
            "notes": { "type": "string" }
          },
          "additionalProperties": true
        },
        "generate_email_request": { "$ref": "#/$defs/generateEmailRequest" }
      },
      "additionalProperties": false
    },
    "expected": {
      "type": "object",
      "required": ["generate_email"],
      "properties": {
        "find_recommendations": {
          "type": "object",
          "properties": {
            "k": { "type": "integer", "minimum": 1 },
            "must_include_candidate_ids": {
              "type": "array",
              "items": { "type": "string" }
            },
            "must_exclude_candidate_ids": {
              "type": "array",
              "items": { "type": "string" }
            },
            "reference_ranking_candidate_ids": {
              "type": "array",
              "items": { "type": "string" }
            },
            "notes": { "type": "string" }
          },
          "additionalProperties": true
        },
        "generate_email": {
          "type": "object",
          "required": ["assertions"],
          "properties": {
            "reference": { "$ref": "#/$defs/emailReference" },
            "assertions": { "$ref": "#/$defs/emailAssertions" }
          },
          "additionalProperties": true
        }
      },
      "additionalProperties": false
    }
  },
  "additionalProperties": true,
  "$defs": {
    "evidenceSnippet": {
      "type": "object",
      "required": ["id", "text"],
      "properties": {
        "id": { "type": "string", "minLength": 1 },
        "text": { "type": "string", "minLength": 1 },
        "url": { "type": "string" }
      },
      "additionalProperties": true
    },
    "candidate": {
      "type": "object",
      "required": ["candidate_id", "name"],
      "properties": {
        "candidate_id": { "type": "string", "minLength": 1 },
        "name": { "type": "string", "minLength": 1 },
        "position": { "type": "string" },
        "field": { "type": "string" },
        "sources": {
          "type": "array",
          "items": { "type": "string" }
        },
        "evidence_snippets": {
          "type": "array",
          "items": { "$ref": "#/$defs/evidenceSnippet" }
        },
        "notes": { "type": "string" }
      },
      "additionalProperties": true
    },
    "profileBase": {
      "type": "object",
      "properties": {
        "name": { "type": "string" },
        "raw_text": { "type": "string" },
        "education": { "type": "array", "items": { "type": "string" } },
        "experiences": { "type": "array", "items": { "type": "string" } },
        "skills": { "type": "array", "items": { "type": "string" } },
        "projects": { "type": "array", "items": { "type": "string" } },
        "links": { "type": "array", "items": { "type": "string" } },
        "evidence_snippets": {
          "type": "array",
          "items": { "$ref": "#/$defs/evidenceSnippet" }
        }
      },
      "additionalProperties": true
    },
    "targetingPreferences": {
      "type": "object",
      "properties": {
        "track": { "type": "string" },
        "search_intent": { "type": "string" },
        "must_have": { "type": "string" },
        "must_not": { "type": "string" },
        "location": { "type": "string" },
        "contactability": { "type": "string" },
        "contact_channels": {
          "type": "array",
          "items": { "type": "string", "enum": ["email", "linkedin", "phone", "other"] }
        },
        "target_role_titles": {
          "type": "array",
          "items": { "type": "string" }
        },
        "seniority": { "type": "string" },
        "org_type": { "type": "string" },
        "bank_tier": {
          "type": "string",
          "enum": ["BB", "EB", "MM", "Regional", "Boutique", "Unknown"]
        },
        "group": { "type": "string" },
        "group_type": { "type": "string", "enum": ["coverage", "product", "unknown"] },
        "sector": { "type": "string" },
        "stage": { "type": "string" },
        "recruiting_context": {
          "type": "object",
          "properties": {
            "role_type": { "type": "string", "enum": ["SA", "FT", "experienced", "unknown"] },
            "timeline": { "type": "string" },
            "notes": { "type": "string" }
          },
          "additionalProperties": true
        },
        "outreach_goal": { "type": "string" },
        "prominence": { "type": "string" },
        "examples": { "type": "string" },
        "evidence": { "type": "string" },
        "extra": { "type": "string" }
      },
      "additionalProperties": true
    },
    "senderProfile": {
      "allOf": [
        { "$ref": "#/$defs/profileBase" },
        {
          "type": "object",
          "properties": {
            "motivation": { "type": "string" },
            "ask": { "type": "string" }
          }
        }
      ]
    },
    "receiverProfile": {
      "allOf": [
        { "$ref": "#/$defs/profileBase" },
        {
          "type": "object",
          "properties": {
            "context": { "type": "string" },
            "sources": {
              "anyOf": [
                { "type": "array", "items": { "type": "string" } },
                { "type": "null" }
              ]
            }
          }
        }
      ]
    },
    "generateEmailRequest": {
      "type": "object",
      "required": ["sender", "receiver", "goal"],
      "properties": {
        "sender": { "$ref": "#/$defs/senderProfile" },
        "receiver": { "$ref": "#/$defs/receiverProfile" },
        "goal": { "type": "string", "minLength": 1 },
        "template": { "anyOf": [{ "type": "string" }, { "type": "null" }] },
        "email_spec": { "$ref": "#/$defs/emailSpec" }
      },
      "additionalProperties": true
    },
    "askSpec": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "enum": ["call", "coffee_chat", "intro", "email_reply", "other"]
        },
        "duration_minutes": { "type": "integer", "minimum": 5 },
        "timeframe": { "type": "string" },
        "time_windows": { "type": "array", "items": { "type": "string" } },
        "async_option": { "type": "string" }
      },
      "additionalProperties": true
    },
    "complianceGuardrails": {
      "type": "object",
      "properties": {
        "forbid_investment_advice": { "type": "boolean" },
        "forbid_return_promises": { "type": "boolean" },
        "forbid_insider_info": { "type": "boolean" },
        "forbid_mentioning_unpublished_deals": { "type": "boolean" }
      },
      "additionalProperties": true
    },
    "emailSpec": {
      "type": "object",
      "properties": {
        "output_language": { "type": "string", "enum": ["en", "zh", "mixed"] },
        "tone": { "type": "string" },
        "max_words": { "type": "integer", "minimum": 20 },
        "max_chars": { "type": "integer", "minimum": 60 },
        "one_ask": { "$ref": "#/$defs/askSpec" },
        "value_offer": { "type": "string" },
        "hard_rules": { "type": "array", "items": { "type": "string" } },
        "compliance_guardrails": { "$ref": "#/$defs/complianceGuardrails" },
        "must_cite_evidence": { "type": "boolean" }
      },
      "additionalProperties": true
    },
    "emailReference": {
      "type": "object",
      "properties": {
        "subject": { "type": "string" },
        "body_lines": {
          "type": "array",
          "items": { "type": "string" }
        }
      },
      "additionalProperties": true
    },
    "emailAssertions": {
      "type": "object",
      "required": ["language", "required_elements"],
      "anyOf": [{ "required": ["max_words"] }, { "required": ["max_chars"] }],
      "properties": {
        "language": { "type": "string", "enum": ["en", "zh", "mixed"] },
        "max_words": { "type": "integer", "minimum": 20 },
        "max_chars": { "type": "integer", "minimum": 60 },
        "must_include_phrases": {
          "type": "array",
          "items": { "type": "string" }
        },
        "forbidden_phrases": {
          "type": "array",
          "items": { "type": "string" }
        },
        "required_elements": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["subject_line", "why_them", "value", "clear_ask", "opt_out"]
          }
        },
        "compliance": {
          "type": "object",
          "properties": {
            "forbid_investment_advice": { "type": "boolean" },
            "forbid_return_promises": { "type": "boolean" },
            "forbid_insider_info": { "type": "boolean" }
          },
          "additionalProperties": true
        }
      },
      "additionalProperties": true
    }
  }
}
